name: Test Runner

on:
  workflow_run:
    workflows:
      - "CI - Vérification HTML"
    types:
      - completed

jobs:
  test-runner:
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    runs-on:
      - self-hosted
      - linux
      - x64

    steps:
      - name: Recuperation du code
        uses: actions/checkout@v3

      - name: Déploiement (Mise en production)
        run: |
          cp index.html /var/www/html/index.html
          echo "Le site a été déployé sur $(hostname)"

      - name: Verification
        run: echo "Test de fonctionnement du Runner!"

      - name: Tests de commandes
        run: |
          echo "Runner OK"
          hostname
          whoami
          uname -a
